ODDMU(1)

# NAME

oddmu - a wiki server

Oddmu is sometimes written Oddµ because µ is the letter mu.

# SYNOPSIS

*oddmu*

# DESCRIPTION

The oddmu program serves the current working directory as a wiki on port 8080.
Point your browser to http://localhost:8080/ to get started. This is equivalent
to http://localhost:8080/view/index – the first page you'll create, most likely.

If you request a page that doesn't exist, oddmu tries to find a matching
Markdown file by appending the extension ".md" to the page name. In the example
above, the page name requested is "index" and the file name oddmu tries to read
is "index.md". If no such file exists, oddmu offers you to create the page.

If your files don't provide their own title ("# title"), the file name (without
".md") is used for the page title.

Every file can be viewed as feed by using the extension ".rss". The
feed items are based on links in bullet lists using the asterix
("\*").

Subdirectories are created as necessary.

See _oddmu_(5) for details about the page formatting.

# CONFIGURATION

The template files are the HTML files in the working directory:
"add.html", "diff.html", "edit.html", "search.html", "upload.html" and
"view.html". Feel free to change the templates and restart the server.

The first change you should make is to replace the name and email
address in the footer of "view.html". Look for "Your Name" and
"example.org".

The second change you should make is to replace the name, email
address and domain name in "feed.html". Look for "Your Name" and
"example.org". This second template is used to generate the RSS feeds
(despite its ".html" extension).

See _oddmu-templates_(5) for more.

# ENVIRONMENT

You can change the port served by setting the ODDMU_PORT environment variable.

In order to limit language-detection to the languages you actually use, set the
environment variable ODDMU_LANGUAGES to a comma-separated list of ISO 639-1
codes, e.g. "en" or "en,de,fr,pt".

You can enable webfinger to link fediverse accounts to their correct profile
pages by setting ODDMU_WEBFINGER to "1". See _oddmu_(5).

# SECURITY

If the machine you are running Oddmu on is accessible from the Internet, you
must secure your installation. The best way to do this is use a regular web
server as a reverse proxy.

See _oddmu-apache_(5) for an example.

Oddmu assumes that all the users that can edit pages or upload files are trusted
users and therefore their content is trusted. Therefore, Oddmu doesn't perform
HTML sanitization!

# OPTIONS

The oddmu program can be run on the command-line using various subcommands.

- to generate the HTML for a single page, see _oddmu-html_(1)
- to generate the HTML for the entire site, using Oddmu as a static site
  generator, see _oddmu-static_(1)
- to search a regular expression and replace it across all files, see
  _oddmu-replace_(1)
- to emulate a search of the files, see _oddmu-search_(1); to understand how the
  search engine indexes pages and how it sorts and scores results, see
  _oddmu-search_(7)
- to find missing pages (local links that go nowhere), see _oddmu-missing_(1)
- to add links to changes, index and hashtag pages to pages you created locally,
  see _oddmu-notify_(1)

# EXAMPLE

When saving a page, the page name is take from the URL and the page content is
taken from the "body" form parameter. To illustrate, here's how to edit a page
using _curl_(1):

```
curl --form body="Did you bring a towel?" \
  http://localhost:8080/save/welcome
```

# DESIGN

This is a minimal wiki. There is no version history. It's well suited as a
_secondary_ medium: collaboration and conversation happens elsewhere, in chat,
on social media. The wiki serves as the text repository that results from these
discussions.

The idea is that the webserver handles as many tasks as possible. It logs
requests, does rate limiting, handles encryption, gets the certificates, and so
on. The web server acts as a reverse proxy and the wiki ends up being a content
management system with almost no structure – or endless malleability, depending
on your point of view. See _oddmu-apache_(5).

# NOTES

Page names are filenames with ".md" appended. If your filesystem cannot handle
it, it can't be a page name. Filenames can contain slashes and oddmu creates
subdirectories as necessary.

Files may not end with a tilde ('~') – these are backup files. When saving pages
and file uploads, the old file renamed to the backup file unless the backup file
is less than an hour old, thus collapsing all edits made in an hour into a
single diff when comparing backup and current version.

The *index* page is the default page. People visiting the "root" of the site are
redirected to "/view/index".

The *changes* page is where links to new and changed files are added. As an
author, you can prevent this from happening by deselecting the checkbox "Add
link to the list of changes." The changes page can be edited like every other
page, so it's easy to undo mistakes.

Links on the changes page are grouped by date. When new links are added, the
current date of the machine Oddmu is running on is used. If a link already
exists on the changes page, it is moved up to the current date. If that leaves
an old date without any links, that date heading is removed.

If you want to link to the changes page, you need to do this yourself. Add a
link from the index, for example. The "view.html" template currently doesn't do
it. See _oddmu-templates_(5) if you want to add the link to the template.

A page whose name starts with an ISO date (YYYY-MM-DD, e.g. "2023-10-28") is
called a *blog* page. When creating or editing blog pages, links to it are added
from other pages.

If the blog page name starts with the current year, a link is created from the
index page back to the blog page being created or edited. Again, you can prevent
this from happening by deselecting the checkbox "Add link to the list of
changes." The index page can be edited like every other page, so it's easy to
undo mistakes.

For every *hashtag* used, another link might be created. If a page named like
the hashtag exists, a backlink is added to it, linking to the new or edited blog
page.

If a link to the new or edited blog page already exists but it's title is no
longer correct, it is updated.

New links added for blog pages are added at the top of the first unnumbered list
using the asterisk ('\*'). If no such list exists, a new one is started at the
bottom of the page. This allows you to have a different unnumbered list further
up on the page, as long as it uses the minus for items ('-').

Changes made locally do not create any links on the changes page, the index page
or on any hashtag pages. See _oddmu-notify_(1) for a way to add the necessary
links to the changes page and possibly to the index and hashtag pages.

A hashtag consists of a number sign ('#') followed by Unicode letters, numbers
or the underscore ('\_'). Thus, a hashtag ends with punctuation or whitespace.

The page names, titles and hashtags are loaded into memory when the server
starts. If you have a lot of pages, this takes a lot of memory. If you change
the files while the wiki runs, changes to names (creating, renaming or deleting
files), titles or hashtags confuse Oddmu. Restart the program in order to
resolve this.

You cannot edit uploaded files. If you upload a file called "hello.txt" and
attempt to edit it by using "/edit/hello.txt" you create a page with the name
"hello.txt.md" instead.

You cannot delete uploaded files via the web – but you can delete regular wiki
pages by saving an empty page.

# SEE ALSO

- _oddmu_(5), about the markup syntax and how feeds are generated based on link lists
- _oddmu.service_(5), on how to run the service under systemd
- _oddmu-apache_(5), on how to set up a web server such as Apache
- _oddmu-html_(1), on how to render a page from the command-line
- _oddmu-list_(1), on how to list pages and titles from the command-line
- _oddmu-missing_(1), on how to find broken local links from the command-line
- _oddmu-replace_(1), on how to search and replace text from the command-line
- _oddmu-search_(1), on how to run a search from the command-line
- _oddmu-search_(7), on how search works
- _oddmu-static_(1), on generating a static site from the command-line
- _oddmu-templates_(5), on how to write the HTML templates

# AUTHORS

Maintained by Alex Schroeder <alex@gnu.org>.
